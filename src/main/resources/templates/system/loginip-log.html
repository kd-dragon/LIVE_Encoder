<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="inc/_header"></div>

<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
	$(document).ready(
			function() {
				$(".lnb_4").addClass("open");
				$(".lnb_4_4").addClass("open").addClass("active");

				changeSearchTextType(/*[[ ${dto.searchTextType} ]]*/);
				$("#searchText").val(/*[[ ${dto.searchText}]]*/);

				if ($("#searchStDate").val() == "") {
					$("#fullDate").val('');
				} else {
					$("#fullDate").val(
							$("#searchStDate").val() + " ~ "
									+ $("#searchEnDate").val());
				}
			});

	function goList(num) {
		$("#searchText").val($("#searchText").val().trim());
		$("#currentPage").val(num);

		if ($("#fullDate").val() != '') {
			var dateArr = $("#fullDate").val().split(" ~ ");

			$("#searchStDate").val(dateArr[0]);
			$("#searchEnDate").val(dateArr[1]);
		}

		var f = document.theForm;

		f.action = /*[[ @{/system/loginIpLogList.do} ]]*/'/system/loginIpLogList.do';
		f.method = "post";
		f.submit();
	}

	//검색 조건 선택
	function changeSearchTextType(type) {
		if (type == "ALL") {
			$("#searchTextType").val("");
			$("#searchField").text("전체");
		} else if (type == "ID") {
			$("#searchTextType").val("ID");
			$("#searchField").text("아이디");
		} else if (type == "NAME") {
			$("#searchTextType").val("NAME");
			$("#searchField").text("회원명");
		}
	}

	//검색 조건 초기화
	function searchReset() {
		$("#searchIp").val("");
		$("#searchText").val("");
		$("#searchTextType").val("");
		$("#fullDate").val("");
		$("#searchStDate").val("");
		$("#searchEnDate").val("");
		$("#currentPage").val("1");
		$("#blockCount").val(10);

		goList(1);
	}

	//페이징 변경
	function changePaging(num) {
		$("#blockCount").val(num);
		goList(1);
	}
	/*]]*/
</script>

<form id="theForm" name="theForm" method="post">
	<input type="hidden" id="blockCount" name="blockCount"
		th:value="${dto.blockCount}" /> <input type="hidden" id="currentPage"
		name="currentPage" th:value="${dto.currentPage}" /> <input
		type="hidden" id="searchTextType" name="searchTextType"
		th:value="${dto.searchTextType}" /> <input type="hidden"
		name="searchStDate" id="searchStDate" th:value="${dto.searchStDate}" />
	<input type="hidden" name="searchEnDate" id="searchEnDate"
		th:value="${dto.searchEnDate}" />
		<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
	<!-- 컨텐츠 영역 -->
	<div class="app-content content">
		<div class="content-wrapper">
			<!-- 컨텐츠:헤더-페이지명,네비게이터 -->
			<div class="content-header row">
				<div class="content-header-left col-md-8 col-12 mb-2 breadcrumb-new">
					<h3 class="content-header-title mb-0 d-inline-block">로그인 IP 로그</h3>
					<div class="row breadcrumbs-top d-inline-block">
						<div class="breadcrumb-wrapper col-12">
							<ol class="breadcrumb">
								<li class="breadcrumb-item">Home</li>
								<li class="breadcrumb-item">시스템관리</li>
								<li class="breadcrumb-item active">로그인 IP 로그</li>
							</ol>
						</div>
					</div>
				</div>
			</div>
			<!--// 컨텐츠:헤더-페이지명,네비게이터 -->
			<!-- 컨텐츠:본문 영역 -->
			<div class="content-body">

				<div class="row">
					<!-- 인코딩작업로그 목록 -->
					<div class="col-xl-12">
						<div class="card">
							<div class="card-header">
								<h4 class="card-title">로그인 IP 로그</h4>
								<div class="heading-elements">
									<button type="button" class="btn btn-secondary btn-sm "
										onclick="searchReset();">
										<i class="fa fa-repeat"></i> 검색조건 초기화
									</button>
									<button type="button" class="btn btn-primary btn-sm "
										onclick="goList(1);">
										<i class="fa fa-search"></i> 조회
									</button>
								</div>
							</div>
							<div class="card-content ">
								<div class="card-body">
									<!-- 검색 -->
									<div class="search-area">
										<table cellpadding="0" cellspacing="0" class="w-100"
											summary="">
											<colgroup>
												<col width="9%" />
												<col width="13%" />
												<col width="9%" />
												<col width="17%" />
												<col width="9%" />
												<col width="17%" />
											</colgroup>
											<tbody>
												<tr>
													<th scope="col">접속IP</th>
													<td><input type="text"
														class="form-control min-width-5"
														th:value="${dto.searchIp}" id="searchIp" name="searchIp" /></td>
													<th scope="col">
														<div class="position-relative">
															<button type="button" class="btn dropdown-toggle"
																data-toggle="dropdown" aria-haspopup="true"
																aria-expanded="true" id="searchField" name="searcgField">전체</button>
															<div class="dropdown-menu">
																<a class="dropdown-item"
																	href="javascript:changeSearchTextType('ALL')">전체</a> <a
																	class="dropdown-item"
																	href="javascript:changeSearchTextType('NAME')">회원명</a>
																<a class="dropdown-item"
																	href="javascript:changeSearchTextType('ID')">아이디</a>
															</div>
														</div>
													</th>
													<td><input type="text" class="form-control" value=""
														name="searchText" id="searchText" /></td>
													<th scope="col">조회기간</th>
													<td>
														<div class="w-100 ">
															<!-- 일정 inputbox사용을 위해 필요한 참조 값 -->
															<input id="picker_from" style="display: none;"><input
																id="picker_to" style="display: none;">
															<!-- 일정 inputbox사용을 위해 필요한 참조 값 -->
															<div class="input-group normal-child">
																<div class="input-group-prepend">
																	<span class="input-group-text"> <span
																		class="fa fa-calendar-o"></span>
																	</span>
																</div>
																<input type='text' class="form-control daterange"
																	value="" id="fullDate" name="fullDate" readonly />
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
									<!--// 검색 -->

									<div class="list-summary no-line mt-1">
										<div class="list-count">
											전체 : <b>[[ ${dto.totalCount} ]]</b>개 ([[ ${dto.currentPage}
											]]/[[ ${dto.totalPage} ]]페이지)
										</div>
										<div class="page-count">
											<button type="button"
												class="btn btn-light btn-sm dropdown-toggle"
												data-toggle="dropdown" aria-haspopup="true"
												aria-expanded="true">[[ ${dto.blockCount} ]]개씩보기</button>
											<div class="dropdown-menu">
												<a class="dropdown-item" href="javascript:changePaging(10)">10개씩보기</a>
												<a class="dropdown-item" href="javascript:changePaging(20)">20개씩보기</a>
												<a class="dropdown-item" href="javascript:changePaging(40)">40개씩보기</a>
												<a class="dropdown-item" href="javascript:changePaging(80)">80개씩보기</a>
												<a class="dropdown-item" href="javascript:changePaging(100)">100개씩보기</a>
											</div>
										</div>
									</div>

									<!--  테이블 -->
									<div class="view-form view-poll even-line">
										<table cellpadding="0" cellspacing="0"
											class="w-100 text-center mb-0" summary="">
											<colgroup>
												<col width="10%" />
												<col width="10%" />
												<col width="20%" />
												<col width="13%" />
												<col width="12%" />
												<col width="10%" />
												<col width="25%" />
											</colgroup>
											<thead>
												<tr>
													<th>No</th>
													<th>사이트</th>
													<th>접속IP</th>
													<th>아이디</th>
													<th>회원명</th>
													<th>접속성공여부</th>
													<th>접속일시</th>
												</tr>
											</thead>
											<tbody>
												<tr th:if="${#lists.isEmpty(dto.ipLogList)}">
													<td colspan="7"
														class="py-5 border-bottom border-light-gray ">로그 기록이
														없습니다.
													</td>
												</tr>
												<tr th:unless="${#lists.isEmpty(dto.ipLogList)}"
													th:each="item : ${dto.ipLogList}">
													<td
														th:text="${dto.totalCount - (dto.blockCount * (dto.currentPage - 1) + itemStat.index)}"></td>
													<td th:text="${item.lclType}"></td>
													<td th:text="${item.lclIp}"></td>
													<td th:text="${item.luId}"></td>
													<td th:text="${item.luName}"></td>
													<td th:text="${item.lclCode}"></td>
													<td th:text="${item.lclRegDate}"></td>
												</tr>
											</tbody>
										</table>
									</div>
									<!--// 테이블 -->

									<!-- 페이징 -->
									<div th:utext="${dto.pagingHtml}"></div>
									<!-- //페이징 -->

								</div>
							</div>
						</div>
					</div>
					<!--// 인코딩작업로그 목록 -->
				</div>
			</div>
			<!--// 컨텐츠 본문 영역 -->
		</div>
	</div>
</form>
<!--// 컨텐츠 영역 -->


<div th:replace="inc/_footer"></div>