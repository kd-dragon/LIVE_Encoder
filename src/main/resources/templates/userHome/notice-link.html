<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="inc/_header"></div>

<script language="javascript" type="text/javascript" th:inline = "javascript">
/*<![CDATA[*/
var token = $("meta[name='_csrf']").attr("content");
var header = $("meta[name='_csrf_header']").attr("content");

$(document).ready(function(){
	$(".lnb_5").addClass("open"); 
	$(".lnb_5_2").addClass("active");
});

function addLink() {
	var linkCount = $("#linkTable > tbody tr").length + 1;
	
	if(linkCount > 5) {
		alert("공지사항 링크는 5개까지 가능합니다.");
		return;
	} else {
		var html = "";
		html += '<tr>';
		html += '<th>' + linkCount + '</th>';
		html += '<td>';
		html += 	'<div class="input-group mb-Half">';
		html += 		'<div class="input-group-prepend quick-link-text">';
		html += 			'<div class="input-group-text">문구</div>';
		html += 		'</div>';
		html += 		'<input type="text" class="form-control" title="" value="" name="noticeDesc" id="noticeDesc'+ linkCount + '"/>';
		html += 		'<div class="input-group-append">';
		html += 			'<a href="##" onclick="delStr(noticeDesc'+linkCount+');" class="input-group-text d-block" id="delStr' + linkCount+'"><i class="ft-x"></i></a>';
		html += 		'</div>';
		html += 	'</div>';
		html += 	'<div class="input-group">';
		html += 		'<div class="input-group-prepend quick-link-text">';
		html += 			'<div class="input-group-text">URL</div>';
		html += 		'</div>';
		html += 		'<input type="text" class="form-control" title="" value="" name="noticeUrl" id="noticeUrl' + linkCount + '"/>';
		html += 		'<div class="input-group-append">';
		html += 			'<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a>';
		html +=			'</div>';
		html += 	'</div>';
		html += '<input type="hidden" name="noticeSeq" id="noticeSeq'+ linkCount + '"/>';
		html += '</td>';
		html += '<td><button type="button" class="btn btn-secondary btn-xs">삭제</button></td>';
		html += '</tr>';
		
		$("#linkList").append(html);
	}
		
}

function noticeSave() {
	var notice1 = {};
	var notice2 = {};
	var notice3 = {};
	var notice4 = {};
	var notice5 = {};
	
	for(var i = 1; i <= $("#linkTable > tbody tr").length; i++) {
		var noticeSeq = $("#noticeSeq"+i).val();
		var noticeUrl = $("#noticeUrl"+i).val();
		var noticeDesc = $("#noticeDesc"+i).val();
		var noticeOrder = $("#noticeOrder"+i).val();
		
		eval("notice"+i+".noticeSeq=\""+noticeSeq+"\"");
		eval("notice"+i+".noticeUrl=\""+noticeUrl+"\"");
		eval("notice"+i+".noticeDesc=\""+noticeDesc+"\"");
		eval("notice"+i+".noticeOrder=\""+noticeOrder+"\"");
	}
	
	var jsonData = {
			notice1 : notice1,
			notice2 : notice2,
			notice3 : notice3,
			notice4 : notice4,
			notice5 : notice5
	};
	
	$.ajax({
		beforeSend: function(xhr) {
			xhr.setRequestHeader(header, token);
		},
		url : /*[[ @{/userHome/noticeInsert.do}]]*/ '/userHome/noticeInsert.do',
		data : JSON.stringify(jsonData),
		dataType : 'text',
		type : "POST",
		traditional : true,
		contentType : 'application/json',
		success : function(type) {
			if(type == "SUCCESS") {
				alert("정상적으로 저장되었습니다.");
				reload();
			} else {
				alert("저장 처리 중, 오류가 발생하였습니다. 다시 시도해주세요.");
			}
		},
		error : function(e) {
			alert("시스템 에러가 발생하였습니다. 관리자에게 문의하세요.");
		}
	});
}

function delYnChange(id) {
	var noticeSeq = $("#"+id).val();
	if(noticeSeq == null || noticeSeq == "") {
		alert("적용된 공지사항이 없습니다.");
	} else {
		var jsonData = {
				"delYn" : 'Y',
				"noticeSeq" : noticeSeq
		};
		
		$.ajax({
			beforeSend: function(xhr) {
				xhr.setRequestHeader(header, token);
			},
			url : /*[[ @{/userHome/noticeDelete.do}]]*/ '/userHome/noticeDelete.do',
			data : JSON.stringify(jsonData),
			dataType : 'text',
			type : 'POST',
			contentType : 'application/json',
			success : function(type) {
				if(type == "SUCCESS") {
					alert("해당 공지사항이 삭제되었습니다.");
					reload();
				} else {
					alert("삭제 처리 중, 오류가 발생하였습니다. 다시 시도해주세요.")
				}
			},
			error : function(e) {
				alert("시스템 에러가 발생하였습니다. 관리자에게 문의하세요.");
			}
		});
	}
}

// function noticeSave() {
// 	var saveList = new Array();
// 	var trCount = $("#linkList").children();
	
// 	trCount.each(function(idx) {
// 		var param = new Object();
// 		var index = idx+1;
		
// 		param.noticeSeq = $("#noticeSeq" + index).val();
// 		param.noticeUrl = $("#noticeUrl" + index).val();
// 		param.noticeDesc = $("#noticeDesc" + index).val();
		
// 		saveList.push(param);
		
// 	});
	
// 	var jsonData = {
// 		"saveList" : saveList
// 	};
	
// // 	var jsonData = {
// // 		"noticeUrl" : $("#noticeUrl"+1).val(),
// // 		"noticeDesc" : $("#noticeDesc"+1).val()
		
// // 	};
	
// 	$.ajax({
// 		beforeSend : function(xhr) {
// 			xhr.setRequestHeader(header, token);
// 		},
// 		url : /*[[ @{/userHome/noticeInsert.do}]]*/ '/userHome/noticeInsert.do',
// 		data : JSON.stringify(jsonData),
// 		type : "POST",
// 		dataType : 'text',
// 		contentType : 'application/json',
// 		success : function(type) {
// 			if(type == "SUCCESS") {
// 				alert("공지사항이 저장되었습니다.");
// 				reload();
// 			} else {
// 				alert("공지사항 저장에 실패했습니다. 다시 시도해주세요.");
// 			}
// 		},
// 		error : function(e) {
// 			alert("시스템 에러가 발생하였습니다 .관리자에게 문의하세요.");
// 		}
// 	});
// }

function reload() {
	window.location.reload();
}

function delStr(t) {
	$("#"+t).val("");
}

/*]]*/
</script>
<!--//좌측메뉴영역-->
<style type="text/css">
<!--
.input-group-text [class*=" ft-"], .input-group-text [class^=ft-] {line-height: .8rem;}
.quick-link-text {width: 50px; padding: 0;}
.quick-link-text .input-group-text{width: 100%;}
</style>

<!-- 컨텐츠 영역 -->
<div class="app-content content">
<div class="content-wrapper">
<!-- 컨텐츠:헤더-페이지명,네비게이터 -->
<div class="content-header row">
	<div class="content-header-left col-md-8 col-12 mb-2 breadcrumb-new">
		<h3 class="content-header-title mb-0 d-inline-block">공지사항 바로가기 관리</h3>
		<div class="row breadcrumbs-top d-inline-block">
			<div class="breadcrumb-wrapper col-12">
				<ol class="breadcrumb">
					<li class="breadcrumb-item">회원가입</li>
					<li class="breadcrumb-item">사용자홈페이지관리</li>
					<li class="breadcrumb-item active">공지사항바로가기관리</li>
				</ol>
			</div>
		</div>
	</div>
</div>
<!--// 컨텐츠:헤더-페이지명,네비게이터 -->
<!-- 컨텐츠:본문 영역 -->
<div class="content-body">
	<!-- 디스크립션 -->
	<div class="bs-callout-success mb-2">
		<div class="media align-items-stretch">
			<div class="media-left d-flex align-items-center bg-gray p-2">
				<i class="ft-check-square white font-medium-5"></i>
			</div>
			<div class="media-body p-1">
				<ul class="list-left list-disc mb-0">
					<li>사용자 페이지 상단(로고 우측)에 롤링 형태로 노출되게 됩니다.</li>
					<li>사용자 페이지에서 해당 공지사항 클릭 시 새창으로 연결될 수 있도록 제공됩니다.</li>
					<li>공지사항 바로가기는 최대 5개까지 가능합니다.</li>
				</ul>
			</div>
		</div>
	</div>
	<!--// 디스크립션 -->
	<div class="row">
		<!-- 배너관리 -->
		<div class="col-xl-12">
			<div class="card">
				<div class="card-header">
					<h4 class="card-title">바로가기 목록</h4>
					<div class="heading-elements"></div>
				</div>
				<div class="card-content">
					<div class="card-body">
					<form id="theForm" name="theForm" method="post">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
						<!--  입력테이블 -->
						<div class="w-100 regist-form regist-form-vertical view-poll mb-1">
							<table cellpadding="0" cellspacing="0" class=" w-100 text-center" summary="" id="linkTable">
								<colgroup>
									<col width="10%"/><col width="80%"/><col width="10%"/>
								</colgroup>
								<thead>
									<tr>
										<th>구분</th>
										<th>정보</th>
										<th>관리</th>
									</tr>
								</thead>
								<tbody id="linkList">
									<tr>
										<th>01</th>
										<td th:if="${notice1 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder1" value="1"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice1.noticeDesc}" id="noticeDesc1" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc1');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice1.noticeUrl}" id="noticeUrl1" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl1');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq1" name="noticeSeq" th:value="${notice1.noticeSeq}"/>
										</td>
										
										<td th:unless="${notice1 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder1" value="1"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeDesc1" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc1');" class="input-group-text d-block"><i class="ft-x"></i></a>
<!-- 													<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a> -->
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeUrl1" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl1');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq1" name="noticeSeq"/>
										</td>
										
										<td><button type="button" class="btn btn-secondary btn-xs" onclick="delYnChange('noticeSeq1');">삭제</button></td>
									</tr>
									
									<tr>
										<th>02</th>
										<td th:if="${notice2 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder2" value="2"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice2.noticeDesc}" id="noticeDesc2" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc2');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice2.noticeUrl}" id="noticeUrl2" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl2');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq2" name="noticeSeq" th:value="${notice2.noticeSeq}"/>
										</td>
										
										<td th:unless="${notice2 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder2" value="2"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeDesc2" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc2');" class="input-group-text d-block"><i class="ft-x"></i></a>
<!-- 													<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a> -->
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeUrl2" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl2');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq2" name="noticeSeq"/>
										</td>
										<td><button type="button" class="btn btn-secondary btn-xs" onclick="delYnChange('noticeSeq2');">삭제</button></td>
									
									</tr>
									
									<tr>
										<th>03</th>
										<td th:if="${notice3 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder3" value="3"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice3.noticeDesc}" id="noticeDesc3" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc3');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice3.noticeUrl}" id="noticeUrl3" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl3');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq3" name="noticeSeq" th:value="${notice3.noticeSeq}"/>
										</td>
									
										<td th:unless="${notice3 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder3" value="3"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeDesc3" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc3');" class="input-group-text d-block"><i class="ft-x"></i></a>
<!-- 													<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a> -->
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeUrl3" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl3');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq3" name="noticeSeq"/>
										</td>
										<td><button type="button" class="btn btn-secondary btn-xs" onclick="delYnChange('noticeSeq3');">삭제</button></td>
									
									</tr>
									
									<tr>
										<th>04</th>
										<td th:if="${notice4 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder4" value="4"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice4.noticeDesc}" id="noticeDesc4" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc4');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice4.noticeUrl}" id="noticeUrl4" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl4');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq4" name="noticeSeq" th:value="${notice4.noticeSeq}"/>
										</td>
									
										<td th:unless="${notice4 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder4" value="4"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeDesc4" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc4');" class="input-group-text d-block"><i class="ft-x"></i></a>
<!-- 													<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a> -->
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeUrl4" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl4');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq4" name="noticeSeq"/>
										</td>
										<td><button type="button" class="btn btn-secondary btn-xs" onclick="delYnChange('noticeSeq4');">삭제</button></td>
									
									</tr>
									
									<tr>
										<th>05</th>
										<td th:if="${notice5 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder5" value="5"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice5.noticeDesc}" id="noticeDesc5" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc5');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" th:value="${notice5.noticeUrl}" id="noticeUrl5" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl5');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq5" name="noticeSeq" th:value="${notice5.noticeSeq}"/>
										</td>
										
										<td th:unless="${notice5 != null}">
										<input type="hidden" name="noticeOrder" id="noticeOrder5" value="5"/>
											<div class="input-group mb-Half">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">문구</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeDesc5" name="noticeDesc"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeDesc5');" class="input-group-text d-block"><i class="ft-x"></i></a>
<!-- 													<a href="##" onclick="delStr(noticeUrl'+linkCount+');" class="input-group-text d-block"><i class="ft-x"></i></a> -->
												</div>
											</div>
											<div class="input-group">
												<div class="input-group-prepend quick-link-text">
													<div class="input-group-text">URL</div>
												</div>
												<input type="text" class="form-control" title="" value="" id="noticeUrl5" name="noticeUrl"/>
												<div class="input-group-append">
													<a href="##" th:onclick="delStr('noticeUrl5');" class="input-group-text d-block"><i class="ft-x"></i></a>
												</div>
											</div>
											<input type="hidden" id="noticeSeq5" name="noticeSeq"/>
										</td>
										<td><button type="button" class="btn btn-secondary btn-xs" onclick="delYnChange('noticeSeq5');">삭제</button></td>
									
									</tr>
									
								</tbody>
							</table>
						</div> <!--// 입력테이블 -->

<!-- 						<div class="w-100  text-center"> -->
<!-- 							<button type="button" class="btn btn-outline-info badge-pill px-5" onclick="addLink();">바로가기 추가</button> -->
<!-- 						</div> -->
					</form>
					</div>
				</div>
				<div class="card-footer">
					<div class="mr-auto float-left"></div>
					<div class="mr-auto float-right">
						<button type="button" class="btn btn-success px-2" onclick="noticeSave();">저장</button>
					</div>
				</div>
			</div>
		</div>
		<!--// 배너관리 -->

	</div>
</div>
<!--// 컨텐츠 본문 영역 -->
</div>
</div>
<!--// 컨텐츠 영역 -->
<div th:replace="inc/_footer"></div>