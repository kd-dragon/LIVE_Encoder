<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="live">

	<!-- select preset by Id  -->
	<select id="selectPresetById" parameterType="String" resultType="presetVO">
		SELECT CONTENT_ID
			 , TYPE
			 , CODEC 
			 , QUALITY 
			 , WIDTH 
			 , HEIGHT 
			 , KEEP_RATIO 
			 , RESIZE 
			 , SPEED 
			 , AUDIO_CODEC 
			 , AUDIO_BITRATE 
			 , THUMB_FORMAT 
			 , THUMB_WIDTH 
			 , THUMB_HEIGHT 
			 , THUMB_FIT 
			 , THUMB_SEEK 
			 , THUMB_ESTIMATE 
		FROM TGMOV_PRESET_CONTENT
		WHERE PRESET_ID = #{value}
	</select>
	
	<insert id="insertTgLiveVod" parameterType="LiveBroadcastVO">
		INSERT 
		  INTO TGMOV_VOD(
			   MEDIA_ID
			 , ORIGINAL_FILE_PATH
			 , ORIGINAL_FILE_NAME
			 , ENCODING_FILE_PATH
			 , ENCODING_FILE_NAME
			 , ENCODING_ID
			 , ENC_SIZE
			 , STATUS
			 , CREATE_TIME
		 	 , VOD_TITLE
		 	 , REG_DATE
		 	 , ENC_TYPE
		 	 , OID
		 	 , USE_YN
		 	 , PERCENT
			 , CATEGORY
			 , USER_ID
			 , DURATION
			 , WIDTH
			 , HEIGHT
	     ) 
		SELECT 
			   #{lbSeq}
<!-- 			 , #{vodSavePath} -->
			 , #{recordCopyPath}
			 , CONCAT(#{recordCopyName},'high.mp4')
			 , #{recordCopyPath}
			 , CONCAT(#{recordCopyName},'high.mp4')
			 , #{lbSeq}
			 , #{vodSize}
			 , '2'
			 , NOW()
			 , #{lbTitle}
			 , NOW()
			 , 'video'
			 , 'V'
			 , 'Y'
			 , '100.00'
			 , #{lbCategorySeq}
			 , A.LB_REG_USER_ID
			 , #{lbjDuration}
			 , #{vodWidth}
			 , #{vodHeight}
		  FROM TGLIVE_BROADCAST A
		 WHERE A.LB_SEQ = #{lbSeq}
	</insert>
	
	
	<insert id="insertVodThumnail" parameterType="map">
		INSERT 
		  INTO TGMOV_VOD_THUMB (
		       MEDIA_ID
		     , ENCODING_FILE_PATH
		     , ENCODING_FILE_NAME
		     , REG_DATE
		     , MEDIA_USE
		     , MEDIA_TYPE
		     , REPRIMAGE_YN
		     , THUMB_TIME
		  ) VALUES
		<foreach collection="list" item="item" separator=" UNION ALL ">
			( 
			   #{item.lbSeq}
		  	 , #{item.thumbFilePath}
		  	 , #{item.thumbFileName}
		  	 , NOW()
		  	 , 'Y'
		  	 , 'A'
		  	 , #{item.repreimageYn}
		  	 , #{item.thumbTime}
			)
		</foreach>
	</insert>
	
</mapper>
